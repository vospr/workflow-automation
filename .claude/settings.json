{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'if echo \"$TOOL_INPUT\" | grep -qiE \"git\\s+(add|commit|push)\" && echo \"$TOOL_INPUT\" | grep -qiE \"(\\.env|credentials|secret|password|api.?key|token|private.?key)\"; then echo \"BLOCK: Potential secret in git operation. Review staged files for sensitive data.\"; exit 1; fi; exit 0'"
          }
        ]
      }
    ]
  }
}
